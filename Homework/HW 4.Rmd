---
title: "R Notebook"
output: html_notebook
---

73-74, 77-92, 94, 97


83.
```{r}
states = state.new
multiple_words = function(char_vec) {
  return(length(grep(" ", char_vec)))
}

multiple_words(states)
state.name
```


84.
```{r}
states = state.name
states = gsub(" ","",states, ignore.case = TRUE) #don't count spaces as characters
vowel_count = nchar(gsub("[^aeiou]","",states, ignore.case = TRUE))
consonant_count = nchar(gsub("[aeiou]","",states, ignore.case = TRUE))

sum(vowel_count > consonant_count) #number of states with more vowels than consonants
states
```


85.
```{r}
states = state.name
s_count = nchar(gsub("[^s]","",states, ignore.case = TRUE))
sum(s_count > 3) #number of states with more than 3 s
```


86.
```{r}
states = state.name
sum(grepl("[^aeiou]*[aeiou][aeiou][^aeiou]*$", states, ignore.case = TRUE))
```

87.
```{r}
color = colors()
sum(grepl("red", color, ignore.case = TRUE))
```

88.
```{r}
#Version that considers space as a character
text_char = function(url) {
  text = readLines(url)
  counts = sort(table(unlist(strsplit(text, ""), use.names=FALSE)), decreasing=FALSE)
  return(cat("The most frequent character is", names(counts)[length(counts)], ", which appears" ,max(counts), "times."))
}     

text_char("http://statmath.wu.ac.at/~hornik/index.html")


#Version that does not consider space as a character
text_char_2 = function(url) {
  text = readLines(url)
  text = gsub(" ", "", text, ignore.case=TRUE)
  counts = sort(table(unlist(strsplit(text, ""), use.names=FALSE)), decreasing=FALSE)
  return(cat("The most frequent character is", names(counts)[length(counts)], ", which appears" ,max(counts), "times."))
}

text_char_2("http://statmath.wu.ac.at/~hornik/index.html")
```


89.
```{r}
wc = function(url) {
  text = readLines(url)
  text = gsub("[[:punct:]]", " ", text, ignore.case = TRUE)
  text = gsub("[0-9]", " ", text, ignore.case=TRUE)
  words = strsplit(text, " ")
  counts = sort(table(unlist(words)))
  counts = counts[names(counts) != ""]
  return(cat("The most frequent word is", names(counts)[length(counts)], ", which appears" ,max(counts), "times."))
  
}

wc("http://statmath.wu.ac.at/~hornik/index.html")
```

91.
```{r}
numbertobinary <- function(x) {
  i <- 0
  string <- numeric(32)
  while(x > 0) {
    string[32 - i] <- x %% 2
    x <- x %/% 2
    i <- i + 1 
  }
  first <- match(1, string)
  string[first:32] 
}

numbertobinary(6)
```

92.
```{r}
lettersinstate <- function(x) { 
  inputletters <- sample(letters, size = x )
  inputstate <- sample(state.name, 1)
  print(inputletters)
  print(inputstate)
  for(i in inputletters[1:x]) {
    if(grepl(i, inputstate, ignore.case = TRUE) == F) {
      return(FALSE)
      break
    }
  }
}


lettersinstate(2)
```
