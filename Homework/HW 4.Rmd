---
title: "R Notebook"
output: html_notebook
---

73-74, 77-92, 94, 97


83.
```{r}
states = state.new
multiple_words = function(char_vec) {
  return(length(grep(" ", char_vec)))
}

multiple_words(states)
state.name
```


84.
```{r}
states = state.name
states = gsub(" ","",states, ignore.case = TRUE) #don't count spaces as characters
vowel_count = nchar(gsub("[^aeiou]","",states, ignore.case = TRUE))
consonant_count = nchar(gsub("[aeiou]","",states, ignore.case = TRUE))

sum(vowel_count > consonant_count) #number of states with more vowels than consonants
states
```


85.
```{r}
states = state.name
s_count = nchar(gsub("[^s]","",states, ignore.case = TRUE))
sum(s_count > 3) #number of states with more than 3 s
states
```


86.
This question is ambiguous as what constitutes a double vowel; any vowel twice, or the same vowel twice? Below is a solution to both, respectively.
```{r}
states = state.name
sum(grepl("[aeiou]{2}", states, ignore.case = TRUE))

sum(grepl("(ee)|(aa)|(ii)|(oo)|(uu)", states, ignore.case = TRUE))
```

87.
```{r}
color = colors()
sum(grepl("red", color, ignore.case = TRUE))
```

88.
```{r}
#Version that considers space as a character
text_char = function(url) {
  text = readLines(url)
  counts = sort(table(unlist(strsplit(text, ""), use.names=FALSE)), decreasing=FALSE)
  return(cat("The most frequent character is", names(counts)[length(counts)], ", which appears" ,max(counts), "times."))
}     

text_char("http://statmath.wu.ac.at/~hornik/index.html")


#Version that does not consider space as a character
text_char_2 = function(url) {
  text = readLines(url)
  text = gsub(" ", "", text, ignore.case=TRUE)
  counts = sort(table(unlist(strsplit(text, ""), use.names=FALSE)), decreasing=FALSE)
  return(cat("The most frequent character is", names(counts)[length(counts)], ", which appears" ,max(counts), "times."))
}

text_char_2("http://statmath.wu.ac.at/~hornik/index.html")
```


89.
```{r}
wc = function(url) {
  text = readLines(url)
  text = gsub("[[:punct:]]", " ", text, ignore.case = TRUE)
  text = gsub("[0-9]", " ", text, ignore.case=TRUE)
  words = strsplit(text, " ")
  counts = sort(table(unlist(words)))
  counts = counts[names(counts) != ""]
  return(cat("The most frequent word is", names(counts)[length(counts)], ", which appears" ,max(counts), "times."))
  
}

wc("http://statmath.wu.ac.at/~hornik/index.html")
```


90.
```{r}
word_freq = function(word, url) {
  text = readLines(url)
  text = gsub("[[:punct:]]", " ", text, ignore.case = TRUE)
  text = gsub("[0-9]", " ", text, ignore.case=TRUE)
  text = tolower(text)
  words = strsplit(text, " ")
  counts = sort(table(unlist(words)))
  counts = counts[names(counts) != ""]
  return(counts[[tolower(word)]][1])
  
}

word_freq("div","http://statmath.wu.ac.at/~hornik/index.html")
```


91.
```{r}
numbertobinary <- function(x) {
  i <- 0
  string <- numeric(32)
  while(x > 0) {
    string[32 - i] <- x %% 2
    x <- x %/% 2
    i <- i + 1 
  }
  first <- match(1, string)
  string[first:32] 
}

numbertobinary(6)
```

92.
```{r}
letters_in_state = function(letter_string) {
  state = sample(state.name, 1)
  letter_string_raw = as.list(strsplit(letter_string, "")[[1]])
  print(state)
  
  counter = 0
  for (i in letter_string_raw) {
    if(grepl(i, state, ignore.case=TRUE) == TRUE) {
      counter = counter + 1
    }
  }
  
  if (counter == length(letter_string_raw)){
    return(TRUE)
  }
  else {
    return(FALSE)
  }
}


letters_in_state("Co")
letters_in_state("A")
letters_in_state("u")

```
